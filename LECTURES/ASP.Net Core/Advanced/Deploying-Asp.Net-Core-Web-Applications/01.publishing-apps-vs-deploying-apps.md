# Publishing VS Deploying Apps

- Publishing is done first!
- Deploying is copying the published first to a web server

- In Visual Studio 2019 contains two steps:
-- Publish
--- Debug Publish or Release Publish
--- Deployment Mode:
---- Framework-Dependent => depends on .Net Framework being installed on the destination server
---- Self Contained => all files are contained and deployed to destination server
-- Deploy

## Using dotnet publish Command

```<c#>
    dotnet publish --help => to See Help information

    /// 1. Publish in folder
    dotnet publish -o c:\temp\odetofood

    /// 2. What's deployed
    -- Dependencies (DLLs)
    -- AppSettings for all Environments
    -- Views (DLLs) => Razor Pages
    -- Web.config
    -- wwwroot folder => static content are copied to this folder. Examples: favicon, images, javascript files, .etc

    /// 3. Don't
    -- Can not use "dotnet run"
    -- Specify Assembly
    "dotnet run odetofood.dll"
    -- Might error if it didn't find node_modules folder or some other dependencies
    -- Install by doing "npm install"
```

## Editing MSBuild Configurations

- Right Click Project and select "Edit project.csproj"
-- Opens up project.csproj file with MSBuild commands
- Target => What target to execute in MSBuild

```<xml>
    <Target Name="PostBuild" AfterTargets="ComputeFilesToPublish">
        <Exec Command="npm install" />
    </Target>

    /// Includes all files in the node_modules folder in the published output
    <ItemGroup>
        <Content Include="node_modules/**" CopyToPublishDirectory="PreserveNewest" />
    </ItemGroup>
```

## Building Self Container Applications

- Use --self-contained option with the dotnet exe
-- dotnet publish -o c:\temp\odetofood --self-contained
- Drawbacks
-- Security Patch
- Must Specify a Runtime in a published output => 64-bit, 32-bit, what the target system looks like, operating system, .etc
-- dotnet publish -o c:\temp\odetofood --self-contained -r [Windows RID]

```<cmd>
    dotnet publish -o c:\temp\odetofood --self-contained -r win-x64
```
